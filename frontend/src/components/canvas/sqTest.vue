<template>
<div id="sq-test">

  <svg id="svg" viewBox="0 0 278 120" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>SKEWINGTEST</title>
    <g id="text" transform="translate(-53.000000, -309.000000)">
      <path d="M70.9516602,354.726562 C81.8803711,354.726562 88.5708008,349.337891 88.5708008,340.800781 C88.5708008,334.170898 84.5444336,330.447266 75.3110352,328.600586 L70.6791992,327.662109 C65.5327148,326.632812 63.4135742,324.967773 63.4135742,322.273438 C63.4135742,319.064453 66.440918,316.945312 70.9516602,316.945312 C75.5532227,316.945312 78.7924805,319.185547 79.0952148,322.90918 L87.7231445,322.90918 C87.5717773,314.886719 81.1538086,309.558594 70.9516602,309.558594 C61.2338867,309.558594 54.2709961,314.856445 54.2709961,322.848633 C54.2709961,329.357422 58.5395508,333.535156 67.2583008,335.260742 L71.8598633,336.168945 C77.3393555,337.289062 79.3979492,338.923828 79.3979492,341.799805 C79.3979492,345.008789 76.0678711,347.370117 71.1938477,347.370117 C66.2290039,347.370117 62.5356445,345.19043 61.9604492,341.527344 L53.3325195,341.527344 C53.6049805,349.761719 60.5375977,354.726562 70.9516602,354.726562 Z M103.283691,354 L103.283691,340.649414 L107.370605,335.745117 L120.327637,354 L131.256348,354 L113.970215,329.69043 L130.13623,310.31543 L119.964355,310.31543 L103.556152,330.235352 L103.283691,330.235352 L103.283691,310.31543 L94.1411133,310.31543 L94.1411133,354 L103.283691,354 Z M164.04248,354 L164.04248,346.431641 L144.243652,346.431641 L144.243652,335.412109 L162.922363,335.412109 L162.922363,328.388672 L144.243652,328.388672 L144.243652,317.853516 L164.04248,317.853516 L164.04248,310.31543 L135.101074,310.31543 L135.101074,354 L164.04248,354 Z M188.503418,354 L196.79834,324.150391 L197.070801,324.150391 L205.365723,354 L213.993652,354 L225.588379,310.31543 L216.112793,310.31543 L209.210449,341.951172 L208.968262,341.951172 L200.794434,310.31543 L193.074707,310.31543 L184.900879,341.951172 L184.658691,341.951172 L177.786621,310.31543 L168.311035,310.31543 L179.875488,354 L188.503418,354 Z M239.635254,354 L239.635254,310.31543 L230.492676,310.31543 L230.492676,354 L239.635254,354 Z M255.649902,354 L255.649902,325.391602 L255.922363,325.391602 L276.356934,354 L283.925293,354 L283.925293,310.31543 L275.17627,310.31543 L275.17627,338.772461 L274.934082,338.772461 L254.529785,310.31543 L246.900879,310.31543 L246.900879,354 L255.649902,354 Z M310.868652,354.726562 C323.038574,354.726562 330.243652,347.551758 330.243652,335.654297 L330.243652,330.719727 L311.837402,330.719727 L311.837402,337.379883 L321.343262,337.379883 L321.312988,338.076172 C321.131348,343.495117 316.983887,347.158203 311.02002,347.158203 C303.754395,347.158203 299.152832,341.375977 299.152832,331.900391 C299.152832,322.606445 303.481934,317.126953 310.687012,317.126953 C315.621582,317.126953 319.345215,319.851562 320.677246,324.422852 L329.850098,324.422852 C328.54834,315.583008 320.858887,309.558594 310.656738,309.558594 C297.820801,309.558594 289.828613,318.035156 289.828613,332.021484 C289.828613,346.219727 297.820801,354.726562 310.868652,354.726562 Z M140.580566,428 L140.580566,391.853516 L153.234863,391.853516 L153.234863,384.31543 L118.813965,384.31543 L118.813965,391.853516 L131.437988,391.853516 L131.437988,428 L140.580566,428 Z M187.231934,428 L187.231934,420.431641 L167.433105,420.431641 L167.433105,409.412109 L186.111816,409.412109 L186.111816,402.388672 L167.433105,402.388672 L167.433105,391.853516 L187.231934,391.853516 L187.231934,384.31543 L158.290527,384.31543 L158.290527,428 L187.231934,428 Z M209.785645,428.726562 C220.714355,428.726562 227.404785,423.337891 227.404785,414.800781 C227.404785,408.170898 223.378418,404.447266 214.14502,402.600586 L209.513184,401.662109 C204.366699,400.632812 202.247559,398.967773 202.247559,396.273438 C202.247559,393.064453 205.274902,390.945312 209.785645,390.945312 C214.387207,390.945312 217.626465,393.185547 217.929199,396.90918 L226.557129,396.90918 C226.405762,388.886719 219.987793,383.558594 209.785645,383.558594 C200.067871,383.558594 193.10498,388.856445 193.10498,396.848633 C193.10498,403.357422 197.373535,407.535156 206.092285,409.260742 L210.693848,410.168945 C216.17334,411.289062 218.231934,412.923828 218.231934,415.799805 C218.231934,419.008789 214.901855,421.370117 210.027832,421.370117 C205.062988,421.370117 201.369629,419.19043 200.794434,415.527344 L192.166504,415.527344 C192.438965,423.761719 199.371582,428.726562 209.785645,428.726562 Z M252.562012,428 L252.562012,391.853516 L265.216309,391.853516 L265.216309,384.31543 L230.79541,384.31543 L230.79541,391.853516 L243.419434,391.853516 L243.419434,428 L252.562012,428 Z" id="SKEWINGTEST"></path>
    </g>
  </svg>

  <canvas 
    id="view" 
    class="canvas-style"
  ></canvas>

</div>
</template>



<script>
const paper = require('paper');

export default {
  name: "sqTest",
  props: [ ],
  data() { return {
    scope: null,
  }},
  computed: {

  },
  methods: {



  },
  created() {
    this.scope = new paper.PaperScope();
  },
  mounted() {
    this.scope.setup(document.getElementById('view'));
    var mousePoint = this.scope.view.center;
    var words = this.scope.project.importSVG(document.getElementById('svg'));
      words.visible = true;
      words.fillColor = null;
      words.strokeColor = 'black';
      words.fitBounds(this.scope.view.bounds);
      words.scale(0.8);
    var textGroup = words.children.text;
    textGroup.position = this.scope.view.center;

    console.log(textGroup.children);

    var rect = new this.scope.Rectangle([0, 0], [100, 100]);
    rect.center = mousePoint;
    var path = new this.scope.Path.Rectangle(rect, 6);
    path.strokeColor = 'red';
    console.log(rect);
    console.log(path);

    this.scope.view.onMouseMove = (event) => {
      mousePoint = event.point;
      path.position = mousePoint;
      showIntersections(this.scope, path, textGroup.children[0])
    }

    function showIntersections(scope, path1, path2) {
      var intersections = path1.getIntersections(path2);
      console.log(intersections);
      for (var i = 0; i < intersections.length; i++) {
        new scope.Path.Circle({
          center: intersections[i].point,
          radius: 5,
          fillColor: '#009dec'
        }).removeOnMove();
      }
    }
    

  },
  beforeUpdate() {
    
  },
  beforeCreate() {
    
  },
}
</script>



<style lang="scss" scoped> 
#sq-test {
  position: absolute; top: 0; left: 0;
  width: 100vw; height: 100vh;
  // background-color: azure;
}
.canvas-style {
  position: absolute; top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: cornsilk;
}

#svg {
  // position: relative; top: 300px;
  width: 278px;
  height: 120px;
  display: none;
}

</style>